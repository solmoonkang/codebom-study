# *DNS*

## *Domain* 이란?

---

도메인은 웹 브라우저를 통해 특정 사이트에 진입할 때, IP 주소를 대신하여 사용하는 주소이다.

- 도메인을 이용하면 한 눈에 파악하기 힘든 IP 주소를 보다 분명하게 나타낼 수 있다.

![스크린샷 2024-02-07 오후 12.48.35.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c33fee58-8f40-4523-b222-c56099de30a9/646ad063-30e4-4d38-915a-ade2df34f165/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-02-07_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_12.48.35.png)

예를 들어, Naver의 IP 주소가 *[2](http://223.130.195.200/)23.130.195.200* 라고 한다면, 도메인은 [*`www.naver.com`*](http://www.google.com)으로 나타낼 수 있다.

## *Domain Name System, DNS* 이란?

---

*DNS* 는 도메인 이름을 IP 주소로 변환하거나 IP 주소를 도메인 이름으로 변환하는 데이터베이스 시스템이다.

- *DNS* 는 상위 기관에서 인증된 기관에게 도메인을 생성하거나 IP 주소로 변경할 수 있는 **권한**을 부여한다.
- *DNS* 는 상위 기관과 하위 기관으로 구분되는 **계층 구조**를 가지는 **분산 데이터베이스 구조**이다.

> 예를 들어, 우리가 휴대폰에서 전화할 때, 키패드에 실제 전화번호(010-xxxx-xxxx)를 입력해서 할 수도 있지만, 간단하게 연락처에서 한글로 검색하여 상대에게 전화를 걸 수 있다.
>
>
> 마찬가지로 우리가 웹 사이트에 접속할 때, 서버 IP 주소(*11.32.23.232*)를 입력하지 않고, 사이트 이름(*`www.google.com`*)을 입력해서 접속할 수 있다.
>

<aside>
📌 정리하면, IP 주소 없이 사이트 이름을 통해 접속할 때, 이 이름을 ***도메인*** 이라고 하며, 

이 일을 해주는 서버를 ***DNS 서버*** 라고 한다.

그리고 도메인을 통해 서버에 접속하는 일련의 과정을 ***DNS*** 라고 한다.

</aside>

## *DNS* 구성 요소

---

*DNS* 는 ***Domain Name Space, Name Server, Resolver*** 로 3가지 구성요소로 나눌 수 있다.

***Domain Name Space***(도메인 네임 스페이스):

- 도메인 네임 스페이스는 도메인 이름의 계층적인 구조를 나타내는 시스템이다.
    - 도메인 이름은 오른쪽에서 왼쪽으로 점(.) 으로 구분된 계층 구조로 표현된다.

***Name Server***(네임 서버):

- 네임 서버는 도메인 이름과 IP 주소 간의 매핑 정보를 관리하고 조회 및 요청을 처리하는 서버이다.

***Resolver***(리졸버):

- 리졸버는 클라이언트 측에서 도메인 이름을 IP 주소로 해석하기 위해 사용되는 소프트웨어나 시스템이다.

- **⁉️ 도메인 주소 구조 (IPv4 기준)**


    ![**[ 클라이언트가 보는 도메인 주소의 구조 ]**](https://prod-files-secure.s3.us-west-2.amazonaws.com/c33fee58-8f40-4523-b222-c56099de30a9/104eb4c5-868f-46d3-8c49-7a7bf72bc23c/Untitled.png)
    
    **[ 클라이언트가 보는 도메인 주소의 구조 ]**
    
    ---
    
    - 주소의 영역을 . 으로 구분한다. → 이를 Label 이라고 한다.
        - 하나의 라벨은 최대 63개의 문자로 사용이 가능하다.
        - 대소문자의 구분 없이 알파벳과 ‘-’ 만 가능하다.
        - 전체 도메인 주소의 최대 크기는 255개의 문자까지 가능하다.
    - 주소의 해석은 오른쪽부터 이루어진다.
        - 즉, 최상위 주소는 가장 오른쪽에 있는 곳이 된다.


## *Domain Name Space*, 도메인 네임 스페이스

---

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/c33fee58-8f40-4523-b222-c56099de30a9/d3bf6372-7515-4d44-a6f9-b2a6a50b7276/Untitled.png)

---

도메인 네임 스페이스는 전세계적인 분산 시스템인 *DNS* 가 저장 및 관리하는 계층적인 구조를 의미한다.

- *DNS* 는 도메인 이름을 해당하는 IP 주소로 매핑하여 인터넷 상에서 통신을 가능하게 한다.
- *DNS* 는 도메인 네임 스페이스의 계층 구조를 기반으로 도메인 이름을 해석하여 IP 주소를 찾는다.

도메인 네임 스페이스는 일반적으로 트리 구조로 표현된다.

- 최상위 도메인(*Top-Level Domain*)부터 시작해 하위 도메인(*Subdomain*)까지 계층적으로 구성된다.

도메인 네임 스페이스는 도메인 이름을 계층적으로 구성하여 인터넷에서 고유하게 식별하는 구조를 제공한다.

**[ *Hierarchical Domain Level*, 계층적 도메인 레벨 ]**

---

**계층적 도메인 레벨**은 여러 계층으로 구성되는 도메인 네임 스페이스를 도메인 이름의 구조로 설명할 수 있다.

예를 들어, *“www.example.com.”* 에서

- 맨 뒤에는 *“.”* 이 생략되어 있는데, 이를 루트 도메인(Root Domain) 이라고 한다.
- *“com”* 은 최상위 도메인(Top-Level Domain) 이라고 한다.
- *“example”* 은 두 번째 수준 도메인(Second-Level Domain) 이라고 한다.
- 마지막으로, *“www”* 는 하위 도메인(Sub Domain = Host) 이라고 한다.

**계층적 도메인 레벨**은 도메인 네임 스페이스를 표현하고, 도메인 이름을 관리하는 역할을 한다.

**[ *Fully Qualified Domain Name(FQDN)*, 전체 도메인 이름 ]**

---

**전체 도메인 이름**은 말 그대로 도메인의 전체 이름을 표기하는 방식을 의미한다.

예를 들어, *“www.example.com”*에서 *“com”*이 최상위 도메인이고 *“example”*이 두 번째 수준 도메인이다.

그리고 *“www”*는 *“example.com”*의 서브도메인이다.

따라서, **전체 도메인 이름**은 **계층적 도메인 레벨**을 모두 포함한 *`“www.example.com”`*을 의미한다.

## *Name Server(DNS Server)*, 네임 서버

---

네임 서버는 도메인 이름과 IP 주소를 연결시켜주는 역할을 한다.

도메인 이름은 사람이 쉽게 기억하고 사용할 수 있는 형태지만, 인터넷은 IP 주소를 사용하여 통신한다.

네임 서버는 도메인 이름을 IP 주소로 변환하거나, IP 주소를 도메인 이름으로 매핑하도록 도와준다.

### *Authoritative Server*, 권한 있는 서버

---

권한 있는 서버는 특정 도메인에 대한 정보를 직접 관리하고 있는 서버이다.

- 권한 있는 서버는 IP 주소와 도메인 이름을 매핑한다.
- 권한 있는 서버로는 Root DNS Server, TLD Server, SLD Server 가 있다.

![**[ 4개의 Name(DNS) Server:** 위의 3개 서버는 각각 Root, TLD, SLD 이며, 아래의 DNS Server가 Local Server이다. **]**](https://prod-files-secure.s3.us-west-2.amazonaws.com/c33fee58-8f40-4523-b222-c56099de30a9/eea0a257-4e7c-4fc4-8ba6-a51908e31b5f/Untitled.png)

**[ 4개의 Name(DNS) Server:** 위의 3개 서버는 각각 Root, TLD, SLD 이며, 아래의 DNS Server가 Local Server이다. **]**

**[ *Local DNS Server*, 로컬 네임 서버 ]**

---

로컬 네임 서버는 네트워크 환경에서 도메인 이름을 IP 주소로 변환하는 역할을 담당한다.

- 즉, 클라이언트가 도메인 이름을 입력하면, 해당 도메인 이름에 대한 IP 주소를 찾아주는 역할을 한다.

예를 들어, 인터넷을 사용하기 위해서 IP를 할당해주는 통신사(SKT, KT, LG 등…)에 등록하게 된다.

컴퓨터의 LAN 선을 통해서 인터넷에 연결되면, 가입했던 각 통신사의 로컬 네임 서버가 등록된다.

즉, KT를 사용한다면 KT DNS가 되고, SK를 사용한다면 SK DNS가 자동으로 세팅된다.

**[ *Root DNS Server*, 루트 네임 서버 ]**

---

루트 네임 서버는 DNS 시스템의 최정점으로 가장 상위에는 ICANN이라고 하는 비영리 단체가 있다.

- ICANN가 하는 일은 전세계에 있는 IP 주소를 관리하며 루트 네임 서버들의 관리를 한다.

루트 네임 서버는 *“a.root-server.net”* 과 *“ga NS a.ns.ga”* 으로 표기되어 있다.

- *“a.root-server.net”* 는 a 루트 서버를 의미하며, 루트 서버는 *“a ~ m”* 까지 총 13 대가 존재한다.
- *“ga NS a.ns.ga”* 는 최상위 네임 서버에 대한 정보와 IP 주소를 저장하고 안내한다.

**[ *Top-Level Domain(TLD) DNS Server*, 최상위 도메인 네임 서버 ]**

---

최상위 네임 서버는 루트 네임 서버를 관리하는 ICANN 밑에 Registry(도메인 등록 기관)이 관리하는 서버이다.

- Registry(대행소)는 *“.com”, “.kr”, “.net”* 과 같이 최상위 도메인들을 관리한다.

최상위 네임 서버는 *“a.ns.ga”* 와 *“dns4u.ga NS ns01.freenom.com”* 으로 표기되어 있다.

- 루트 네임 서버와 마찬가지로, *“a.ns.ga”* 라는 서버임을 알 수 있다.
- *“dns4u.ga NS ns01.freenom.com”* 도 마찬가지로, 두 번째 수준 네임 서버에 대한 정보와 IP 주소를 저장하고 안내한다.

**[ *Second-Level Domain(SLD) DNS Server*, 두 번째 수준 도메인 네임 서버 ]**

---

두 번째 수준 네임 서버는 최상위 네임 서버 등록 작업을 대행해주는 Registar(등록 대행자) 업체나 기관이다.

- 클라이언트가 “example.com” 주소를 사용하고 싶다면, Registry(대행소)에 직접 접근하는 것이 아닌,
- Registar(등록 대행자)에게 접근하여 해당 도메인을 사용하고 싶다고 요청한다.

두 번째 수준 네임 서버는 특이하게 *“A 52.231.13.22”* 와 *“CNAME”* 으로 표기되어 있다.

- 여기서 *“A”* 는 IP 주소이고, *“CNAME”* 은 도메인을 의미한다. 즉, 도메인과 IP를 보내는 것을 알 수 있다.

### *Non-Authoritative Server*, 권한 없는 서버

---

권한 없는 서버는 도메인 이름과 IP 주소가 매핑되어 있지 않고, 질의를 통해 IP 주소를 알아내거나 캐시한다.

- ISP가 제공하는 DNS 서버를 말하며, 일반 가정에서 사용한다.
- 대표적으로 Resolver Server, Recursive Server, Recursor 가 있다.

**[ *Resolver*, **리졸버 ]**

---

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/c33fee58-8f40-4523-b222-c56099de30a9/2f3abf17-bff3-478c-9dcd-9b5452ec375a/Untitled.png)

---

리졸버는 웹 브라우저와 같은 DNS 클라이언트의 요청을 네임 서버로 전달하고, 네임 서버로부터 정보(도메인과 IP 주소)를 받아서 클라이언트에게 제공하는 기능을 수행한다.

이 과정에서 리졸버는 하나의 네임 서버에게 DNS 요청을 전달하고, 해당 서버에 정보가 없다면,

다른 네임 서버에게 요청을 보내서 정보를 받는다.

- 리졸버는 이렇게 **재귀적인 질의(Recursive Query)**를 통해서 정보를 얻어낸다.
    - 재귀적 질의는 Local DNS 서버가 여러 DNS 서버에 차례대로 요청하여 답을 찾는 과정이다.

## *DNS* 동작 과정

---

![스크린샷 2024-02-07 오후 4.25.33.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/c33fee58-8f40-4523-b222-c56099de30a9/61bad544-2d79-45c1-b6fa-589c20bd9e5b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2024-02-07_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_4.25.33.png)

---

1. 웹 브라우저에 *“www.naver.com”* 을 입력하면, 먼저 PC에 저장된 Local DNS 서버에게 NAVER에 대한 IP 주소를 요청한다.
    - Local DNS 서버는 자신의 캐시에 도메인 이름과 해당하는 IP 주소가 저장되어 있는지 확인한다.
    - 만약 캐시에 존재한다면, Local DNS 서버는 해당 IP 주소를 클라이언트에게 반환한다.
    - 캐시에 존재하지 않는다면, 그 다음 과정으로 진행한다.
2. Local DNS 서버는 NAVER의 IP 주소를 찾아내기 위해 Root DNS서버에게 NAVER의 IP 주소를 요청한다.
3. Root DNS 서버는 NAVER의 IP 주소를 찾을 수 없다고 다른 DNS 서버에게 요청하라고 응답한다.
4. Local DNS 서버는 “com” 도메인을 관리하는 TLD DNS 서버에 NAVER의 IP 주소를 요청한다.
5. TLD DNS 서버 또한 해당 정보가 없다면, Local DNS 서버에게 IP 주소를 못찾았다며 다른 DNS 서버에게 요청하라고 응답한다.
6. Local DNS 서버는 *“naver.com”* 도메인을 관리하는 SLD DNS 서버에 NAVER의 IP 주소를 요청한다.
7. SLD DNS 서버는 Local DNS 서버에게 NAVER의 IP 주소가 있다고 응답한다.
8. 이를 수신한 Local DNS는 NAVER의 IP 주소를 캐싱하고, 이후 다른 요청이 있을 시 응답할 수 있도록 IP 주소 정보를 PC에 전달해준다.

## ⁉️ 브라우저는 어떻게 DNS 서버를 조회하며, IP 정보를 받을까?